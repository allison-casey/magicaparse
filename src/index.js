import * as R from "ramda";
import fs from "fs-extra";
import {readString, readInt} from "./byteReaders";
import parseChunk from "./chunkParsers";

const parseFileHeader = buffer =>
  R.pipe(
    readString("id"),
    readInt("version")
  )({buffer});

fs.readFile("./src/test/vox/3x3x3.vox").then(buffer => {
  let out = R.pipe(
    parseFileHeader,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk,
    parseChunk
  )(buffer);
  console.log(out.buffer.length);
  // console.log(JSON.stringify(out.chunk, null, 4));
});
